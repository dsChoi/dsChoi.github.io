<!DOCTYPE html>
<html>

<head>
    
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">

<meta name="description" content="stones blog.">
<title>
    mongodb aggregate query example - my name is Stones
</title>


<link rel="shortcut icon" href="/sam.ico">








<link rel="stylesheet" href="/css/main.min.c5514d3530979d291f3497facc20da1cec870028dbc2a3630b64bab8721bbe49.css" integrity="sha256-xVFNNTCXnSkfNJf6zCDaHOyHACjbwqNjC2S6uHIbvkk=" crossorigin="anonymous" media="screen">




  






<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Didact+Gothic">

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://example.com/tn.png"/>

<meta name="twitter:title" content="mongodb aggregate query example"/>
<meta name="twitter:description" content="match , sort, limit SQL query
select * from brand_similarity_v1 where brand = &#34;tulipalee&#34; order by score desc limit 10 mongodb aggregate
db.brand_similarity_v1.aggregate([ { $match : { brand : &#34;tulipalee&#34; } }, { $sort : { score: -1 // descending } }, { $limit : 10 } ]) Mongoldb index 생성
db.brand_similarity_v1.createIndex({key: 1}) //TTL index db.brand_similarity_v1.createIndex( { &#34;ts&#34;: 1 }, { expireAfterSeconds: 3600 } ) // brand_similarity_v1 colllection 에 key column 을 오름차순 index 생성 "/>

<meta property="og:title" content="mongodb aggregate query example" />
<meta property="og:description" content="match , sort, limit SQL query
select * from brand_similarity_v1 where brand = &#34;tulipalee&#34; order by score desc limit 10 mongodb aggregate
db.brand_similarity_v1.aggregate([ { $match : { brand : &#34;tulipalee&#34; } }, { $sort : { score: -1 // descending } }, { $limit : 10 } ]) Mongoldb index 생성
db.brand_similarity_v1.createIndex({key: 1}) //TTL index db.brand_similarity_v1.createIndex( { &#34;ts&#34;: 1 }, { expireAfterSeconds: 3600 } ) // brand_similarity_v1 colllection 에 key column 을 오름차순 index 생성 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/posts/mongodb_03/" />
<meta property="og:image" content="https://example.com/tn.png"/>
<meta property="article:published_time" content="2021-02-23T15:33:33+09:00" />
<meta property="article:modified_time" content="2021-02-23T15:33:33+09:00" /><meta property="og:site_name" content="my name is stones" />


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-184252439-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


    

    
    
    
    <title>
        
        mongodb aggregate query example
        
    </title>
</head>

<body>
    
    
    <header class="wrap flex-container">
        <h1>mongodb aggregate query example</h1>
    </header>
    
    <main class="wrap">
        
<div class="flex-container">
    <aside role="complementary">
        Tue Feb 23, 2021 &#183; 75 words
        <div class="tag-container">
            
            
            
            
            <span class="tag">
                <a href="/tags/mongdodb/">
                    mongdoDB
                </a>
            </span>
            
            
            
            <span class="tag">
                <a href="/tags/mongo/">
                    mongo
                </a>
            </span>
            
            
            
            <span class="tag">
                <a href="/tags/aggregate/">
                    aggregate
                </a>
            </span>
            
            
        </div>
    </aside>
    <hr />
    <article role="article">
        <p><strong>match , sort, limit SQL query</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> brand_similarity_v1
<span style="color:#66d9ef">where</span> brand <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tulipalee&#34;</span>
<span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> score <span style="color:#66d9ef">desc</span>
<span style="color:#66d9ef">limit</span> <span style="color:#ae81ff">10</span>
</code></pre></div><p><strong>mongodb aggregate</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">
db.brand_similarity_v1.<span style="color:#66d9ef">aggregate</span>([
    <span style="color:#960050;background-color:#1e0010">{</span>
        <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">match</span> : <span style="color:#960050;background-color:#1e0010">{</span>
            brand : <span style="color:#e6db74">&#34;tulipalee&#34;</span>
        <span style="color:#960050;background-color:#1e0010">}</span>
    <span style="color:#960050;background-color:#1e0010">}</span>,
    <span style="color:#960050;background-color:#1e0010">{</span>
        <span style="color:#960050;background-color:#1e0010">$</span>sort : <span style="color:#960050;background-color:#1e0010">{</span>
            score: <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">//</span> descending
        <span style="color:#960050;background-color:#1e0010">}</span>
    <span style="color:#960050;background-color:#1e0010">}</span>,
    <span style="color:#960050;background-color:#1e0010">{</span>
        <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">limit</span> : <span style="color:#ae81ff">10</span>
    <span style="color:#960050;background-color:#1e0010">}</span>
])
</code></pre></div><p>Mongoldb index 생성</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">db.brand_similarity_v1.createIndex(<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#66d9ef">key</span>: <span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">}</span>)


<span style="color:#f92672">//</span>TTL <span style="color:#66d9ef">index</span> 
db.brand_similarity_v1.createIndex( <span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#e6db74">&#34;ts&#34;</span>: <span style="color:#ae81ff">1</span> <span style="color:#960050;background-color:#1e0010">}</span>, <span style="color:#960050;background-color:#1e0010">{</span> expireAfterSeconds: <span style="color:#ae81ff">3600</span> <span style="color:#960050;background-color:#1e0010">}</span> )

<span style="color:#f92672">//</span> brand_similarity_v1 colllection <span style="color:#960050;background-color:#1e0010">에</span> <span style="color:#66d9ef">key</span> <span style="color:#66d9ef">column</span> <span style="color:#960050;background-color:#1e0010">을</span> <span style="color:#960050;background-color:#1e0010">오름차순</span> <span style="color:#66d9ef">index</span> <span style="color:#960050;background-color:#1e0010">생성</span>
</code></pre></div>
    </article>
</div>
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "dschoi-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


        
<nav role="navigation" class="flex-container bottom-menu">
    
<hr />
<p>


    
        <a href="/posts">back</a>
        
            &#183;
        
    

    
        
            <a href="/posts">posts</a>
        
    
    
        
            &#183; 
            <a href="/gallery">gallery</a>
        
            &#183; 
            <a href="/portfolio">portfolio</a>
        
            &#183; 
            <a href="/about">who is stones?</a>
        
    
    &#183; 
    <a href="/">
        main
    </a>

</p>
</nav>

    </main>
    
    <footer class="flex-container footer">
</footer>
    
    
</body>

</html>